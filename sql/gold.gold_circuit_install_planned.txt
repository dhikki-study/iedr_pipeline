CREATE TABLE workspace.gold.gold_circuit_install_planned (
  circuit STRING NOT NULL COMMENT 'Circuit/Feeder identifier',
  utility_id STRING NOT NULL COMMENT 'Utility identifier',
  der_category STRING NOT NULL COMMENT 'Installed or Planned',
  project_id STRING NOT NULL COMMENT 'DER project identifier',
  der_type STRING COMMENT 'Type of DER (SolarPV, Wind, EnergyStorage, etc.)',
  der_value DOUBLE COMMENT 'DER capacity in kW',
  nameplate_rating DOUBLE COMMENT 'Nameplate rating',
  street_address STRING COMMENT 'Project location/address',
  der_interconn_loc STRING COMMENT 'Interconnection point',
  project_status STRING COMMENT 'Project status (Planned DER only)',
  completion_date TIMESTAMP COMMENT 'Expected completion date (Planned DER only)',
  gold_load_timestamp TIMESTAMP NOT NULL COMMENT 'When this Gold record was created')
USING delta
PARTITIONED BY (utility_id, der_category)
COMMENT 'Gold layer: All DER details (Installed + Planned) by feeder'
TBLPROPERTIES (
  'delta.autoOptimize.autoCompact' = 'true',
  'delta.autoOptimize.optimizeWrite' = 'true',
  'delta.checkpoint.writeStatsAsJson' = 'false',
  'delta.checkpoint.writeStatsAsStruct' = 'true',
  'delta.enableDeletionVectors' = 'true',
  'delta.feature.appendOnly' = 'supported',
  'delta.feature.deletionVectors' = 'supported',
  'delta.feature.domainMetadata' = 'supported',
  'delta.feature.invariants' = 'supported',
  'delta.feature.rowTracking' = 'supported',
  'delta.minReaderVersion' = '3',
  'delta.minWriterVersion' = '7',
  'delta.parquet.compression.codec' = 'zstd')
