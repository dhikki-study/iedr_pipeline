{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 CREATE TABLE workspace.bronze.bronze_circuits (\
  circuit STRING COMMENT 'Circuit identifier from utility1 (Circuits_Phase3_CIRCUIT)',\
  overunder STRING COMMENT 'Overhead/Underground indicator from utility1 (Circuits_Phase3_OVERUNDER)',\
  nsection STRING COMMENT 'Segment ID from utility1 - NULL for utility2 (NYHCPV_csv_NSECTION)',\
  nfeeder STRING COMMENT 'Circuit/Feeder ID - PRIMARY KEY (NYHCPV_csv_NFEEDER / Master_CDF)',\
  nvoltage DOUBLE COMMENT 'Segment voltage from utility1 - NULL for utility2 (NYHCPV_csv_NVOLTAGE)',\
  nmaxhc DOUBLE COMMENT 'Segment max hosting capacity from utility1 - NULL for utility2 (NYHCPV_csv_NMAXHC)',\
  fvoltage DOUBLE COMMENT 'Feeder voltage in kV (NYHCPV_csv_FVOLTAGE / feeder_voltage)',\
  fmaxhc DOUBLE COMMENT 'Feeder maximum hosting capacity in MW (NYHCPV_csv_FMAXHC / feeder_max_hc)',\
  fminhc DOUBLE COMMENT 'Feeder minimum hosting capacity in MW (NYHCPV_csv_FMINHC / feeder_min_hc)',\
  refresh_since DOUBLE COMMENT 'DG connected since refresh (NULL / feeder_dg_connected_since_refresh)',\
  refresh_date TIMESTAMP COMMENT 'Hosting capacity assessment date (NYHCPV_csv_FHCADATE / hca_refresh_date)',\
  shape_length DOUBLE COMMENT 'Circuit/segment length (Shape_Length / shape_length)',\
  utility_id STRING NOT NULL COMMENT 'Source utility identifier (utility1, utility2, etc.)',\
  ingestion_timestamp TIMESTAMP NOT NULL COMMENT 'When this record was loaded into Bronze',\
  source_file STRING NOT NULL COMMENT 'Original source filename')\
USING delta\
PARTITIONED BY (utility_id)\
COMMENT 'Bronze layer - Raw circuit/feeder data from utility providers'\
TBLPROPERTIES (\
  'delta.autoOptimize.autoCompact' = 'true',\
  'delta.autoOptimize.optimizeWrite' = 'true',\
  'delta.checkpoint.writeStatsAsJson' = 'false',\
  'delta.checkpoint.writeStatsAsStruct' = 'true',\
  'delta.enableChangeDataFeed' = 'true',\
  'delta.enableDeletionVectors' = 'true',\
  'delta.enableRowTracking' = 'true',\
  'delta.feature.appendOnly' = 'supported',\
  'delta.feature.changeDataFeed' = 'supported',\
  'delta.feature.deletionVectors' = 'supported',\
  'delta.feature.domainMetadata' = 'supported',\
  'delta.feature.invariants' = 'supported',\
  'delta.feature.rowTracking' = 'supported',\
  'delta.minReaderVersion' = '3',\
  'delta.minWriterVersion' = '7',\
  'delta.parquet.compression.codec' = 'zstd')\
}